import{v as p}from"./chunk-7AIUYUHY.js";import{Eb as h,g as o,h as n,l,q as u,rb as m,t as c,tb as f}from"./chunk-HRVMPTIP.js";var U=(()=>{let e=class e{constructor(t,r){this.http=t,this.router=r,this.baseUrl=p.baseUrl,this.isLocalStorageAvailable=typeof localStorage<"u"}login(t,r){let i=this.baseUrl+"/auth/login";return this.http.post(i,{email:t,password:r}).pipe(n(s=>this.saveLocalStorage(s)),l(s=>o(s)))}saveLocalStorage(t){return t&&t.access_token?(localStorage.setItem("token",t.access_token),localStorage.setItem("user",JSON.stringify(t.user)),!0):!1}checkAuthentication(){if(!this.isLocalStorageAvailable)return o(!1);let t=localStorage.getItem("token")??"";if(!t)return o(!1);let r=new m({Authorization:`Bearer ${t}`});return this.http.post(`${this.baseUrl}/auth/check-admin`,{},{headers:r}).pipe(n(i=>i.is_admin),l(()=>o(!1)))}logout(){localStorage.removeItem("token"),localStorage.removeItem("user"),setTimeout(()=>{this.router.navigateByUrl("/login")},500)}};e.\u0275fac=function(r){return new(r||e)(c(f),c(h))},e.\u0275prov=u({token:e,factory:e.\u0275fac,providedIn:"root"});let a=e;return a})();export{U as a};
